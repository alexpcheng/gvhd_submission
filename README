Code presented as is for publication by Cheng et al.
